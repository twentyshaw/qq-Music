!function(t){function e(i){if(n[i])return n[i].exports;var s=n[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=1)}([function(t,e){document.querySelectorAll(".nav-item").forEach(function(t){t.addEventListener("click",function(){console.log(this);var t=this.parentElement.children,e=document.querySelector("#".concat(this.dataset.view));console.log(e),Array.prototype.forEach.call(t,function(t){t.classList.remove("active")}),this.classList.add("active"),Array.prototype.forEach.call(e.parentElement.children,function(t){t.classList.add("hide")}),e.classList.remove("hide")})})},function(t,e,n){"use strict";function i(){var t=document.querySelector("#player");t.classList.contains("show")?(t.classList.remove("show"),t.classList.add("hide")):(t.classList.remove("hide"),t.classList.add("show"))}function s(){var t=location.hash;if(/^#player\?.+/.test(t)){var e=t.slice(t.indexOf("?")+1).match(/(\w+)=([^&]+)/g),n=e&&e.reduce(function(t,e){var n=e.split("=");return t[n[0]]=decodeURI(n[1]),t},{});console.log(n),h.play(n),h.show()}else h.hide()}Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),a=(n.n(r),n(2)),o=n(3),c=n(4),l=n(6),u=n(7),h=(new a.a(document.querySelector("#slider")),new o.a(document.querySelector(".radio-list")),new c.a(document.querySelector("#rank-view")),new l.a(document.querySelector("#search-view")),new u.a(document.querySelector("#player")));document.querySelector("#player-btn").addEventListener("click",i),s(),window.addEventListener("hashchange",s)},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}n.d(e,"a",function(){return a});var a=function(){function t(e,n){i(this,t),this.$el=e,this.slides={},this.interval=n||3e3,this.index=0,this.start(),this.launch()}return r(t,[{key:"launch",value:function(){var t=this;return fetch("../json/rec.json").then(function(t){return t.json()}).then(function(t){return t.data.slider}).then(function(e){return t.render(e)}),this}},{key:"render",value:function(t){this.slides=t.map(function(t){return{link:t.linkUrl,image:t.picUrl}}),this.$el.innerHTML='<div class="qq-slider-wrap"></div>',this.$wrap=this.$el.firstChild,this.$wrap.style.width="".concat(100*this.slides.length,"%"),this.$wrap.innerHTML=this.slides.map(function(t){return'<div class="qq-slider-item">\n\t\t\t<a href="'.concat(t.link,'">\n\t\t\t\t<img src="').concat(t.image,'">\n\t\t\t</a>\n\t\t\t</div>')}).join("")}},{key:"start",value:function(){setInterval(this.next.bind(this),this.interval)}},{key:"next",value:function(){if(this.index+=1,this.index==this.slides.length)return this.$wrap.style.transform="translate(0)",void(this.index=0);var t="-".concat(100*this.index/this.slides.length,"%");this.$wrap.style.transform="translate(".concat(t,")")}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}n.d(e,"a",function(){return a});var a=function(){function t(e){i(this,t),this.$el=e,this.launch()}return r(t,[{key:"launch",value:function(){var t=this;return fetch("../json/rec.json").then(function(t){return t.json()}).then(function(t){return t.data.radioList}).then(function(e){return t.render(e)}),this}},{key:"render",value:function(t){this.$el.innerHTML=t.map(function(t){return'\n\t\t\t\t<li class="radio-item"><a href="#">\n\t\t\t\t\t<img src="'.concat(t.picUrl,'">\n\t\t\t\t\t<span class="icon icon_play"></span>\n\t\t\t\t\t<p>').concat(t.Ftitle,"</p>\n\t\t\t\t</a></li>\n\t \t\t")}).join("")}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}n.d(e,"a",function(){return o});var a=n(5),o=function(){function t(e){i(this,t),this.$el=e,this.launch()}return r(t,[{key:"launch",value:function(){var t=this;return fetch("../json/rank.json").then(function(t){return t.json().then(function(t){return t.req_0.data.group})}).then(function(e){return t.render(e)}),console.log(this),this}},{key:"render",value:function(t){var e=this;this.$el.innerHTML=t.map(function(t){return'<ul id="group'.concat(t.groupId,'">\n\t\t\t\t').concat(e.toplist(t.toplist),"\n\t\t\t</ul>")}).join(""),Object(a.a)(this.$el.querySelectorAll("#rank-view .toplist .lazyload"))}},{key:"toplist",value:function(t){var e=this;return t.map(function(t){return'<li class="toplist">\n\t\t\t\t<div class="top-image"><img class="lazyload" data-src="'.concat(t.frontPicUrl,'"></div>\n\t\t\t\t<div class="top-content">\n\t\t\t\t\t<h3 class="top-title">').concat(t.title,'</h3>\n\t\t\t\t\t<ul class="songlist">\n\t\t\t\t\t\t').concat(e.songlist(t.song),"\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</li>")}).join("")}},{key:"songlist",value:function(t){return t.map(function(t,e){return'<li><span class="song-index">'.concat(e+1,'</span><span class="song">').concat(t.title,'</span><span class="singer">').concat(t.singerName,"</span></li>")}).join("")}}]),t}()},function(t,e,n){"use strict";function i(t){var e=Array.prototype.slice.call(t),n=a(function(){if(0===e.length)return window.removeEventListener("scroll",n);e=e.filter(function(t){return t.classList.contains("lazyload")}),e.forEach(function(t){s(t)&&r(t)})},400);window.addEventListener("scroll",n),window.dispatchEvent(new Event("scroll"))}function s(t){var e=t.getBoundingClientRect(),n=e.top,i=e.bottom,s=e.left,r=e.right,a=document.documentElement.clientWidth,o=document.documentElement.clientHeight;return(n>0&&n<o||i>0&&i<o)&&(s>0&&s<a||r>0&&r<a)}function r(t,e){var n=new Image;n.src=t.dataset.src,n.onload=function(){t.src=n.src,t.classList.remove("lazyload"),"function"==typeof e&&e()}}function a(t,e){var n,i;return function(){var s=Date.now(),r=s-n;!n||r>=e?(t(),n=s):r<e&&(clearTimeout(i),i=setTimeout(t,e-r))}}e.a=i},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}n.d(e,"a",function(){return a});var a=function(){function t(e){i(this,t),this.$el=e,this.$input=this.$el.querySelector("#search"),this.$songs=this.$el.querySelector(".song-list"),this.$input.addEventListener("keyup",this.onKeyUp.bind(this)),this.keyword="",this.page=1,this.perpage=20,this.song=[],this.nomore=!1,this.fetching=!1,this.onscroll=this.onScroll.bind(this),window.addEventListener("scroll",this.onscroll)}return r(t,[{key:"onKeyUp",value:function(t){var e=t.target.value.trim();if(!e)return this.reset();"Enter"===t.key&&this.search(e)}},{key:"onScroll",value:function(t){this.nomore||document.documentElement.clientHeight+pageYOffset>document.body.scrollHeight-50&&this.search(this.keyword,this.page+1)}},{key:"reset",value:function(){this.page=1,this.keyword="",this.song=[],this.$songs.innerHTML=""}},{key:"search",value:function(t,e){var n=this;this.fetching||(this.fetching=!0,this.keyword=t,fetch("http://localhost:4000/search?keyword=".concat(this.keyword,"&page=").concat(e||this.page)).then(function(t){return t.json()}).then(function(t){return n.page=t.data.song.curpage,n.nomore="no results"===t.message,console.log(t.data.song.list),t.data.song.list}).then(function(t){return n.append(t)}).then(function(){return n.fetching=!1}).catch(function(){return n.fetching=!1}))}},{key:"append",value:function(t){var e=t.map(function(t){return'<li class="song-item">\n\t\t\t <a href="#player?artist='.concat(t.singer[0].name,"&songid=").concat(t.songid,"&songmid=").concat(t.songmid,"&songname=").concat(t.songname,"&albummid=").concat(t.albummid,"&duration=").concat(t.interval,'">\n\t\t\t\t<i class="icon icon-music"></i>\n\t\t\t\t<div class="song-name ellipsis">').concat(t.songname,'</div>\n\t\t\t\t<div class="song-artist ellipsis">').concat(t.singer.map(function(t){return t.name}).join(""),"</div>\n\t\t\t</a>\n\t\t\t</li>")}).join("");this.$songs.insertAdjacentHTML("beforeend",e)}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}n.d(e,"a",function(){return c});var a=n(8),o=n(9),c=function(){function t(e){i(this,t),this.$el=e,this.$el.addEventListener("click",this),this.creatAudio(),this.progress=new a.a(this.$el.querySelector(".progress"),!1),this.lyrics=new o.a(this.$el.querySelector(".lyric"))}return r(t,[{key:"creatAudio",value:function(){this.$audio=document.createElement("audio"),this.$audio.loop=!0,document.body.appendChild(this.$audio)}},{key:"handleEvent",value:function(t){var e=t.target;switch(console.log(e),!0){case e.matches(".icon-play"):this.onPlay(t);break;case e.matches(".icon-pause"):this.onPause(t);break;case e.matches(".album-img"):this.switchLyric(t);break;case e.matches(".lyrics-lines"):this.switchAlbum(t)}}},{key:"onPlay",value:function(t){this.$audio.play(),this.progress.start(),t.target.classList.remove("icon-play"),t.target.classList.add("icon-pause")}},{key:"onPause",value:function(t){this.$audio.pause(),this.progress.pause(),t.target.classList.remove("icon-pause"),t.target.classList.add("icon-play")}},{key:"switchLyric",value:function(t){t.target.parentNode.classList.contains("show")&&(t.target.parentNode.classList.remove("show"),t.target.parentNode.classList.add("hide"),t.target.parentNode.nextElementSibling.classList.remove("hide"),t.target.parentNode.nextElementSibling.classList.add("show"))}},{key:"switchAlbum",value:function(t){t.target.parentNode.parentNode.classList.contains("show")&&(t.target.parentNode.parentNode.classList.remove("show"),t.target.parentNode.parentNode.classList.add("hide"),t.target.parentNode.parentNode.previousElementSibling.classList.remove("hide"),t.target.parentNode.parentNode.previousElementSibling.classList.add("show"))}},{key:"play",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e){this.$el.querySelector(".song-name").innerText=e.songname,this.$el.querySelector(".singer-name").innerText=e.artist,this.progress.reset(e.duration);var n="https://y.gtimg.cn/music/photo_new/T002R300x300M000".concat(e.albummid,".jpg?max_age=2592000");this.$el.querySelector(".album-img").src=n,this.$el.querySelector(".bg img").src=n,e.songid&&(console.log(e.songid),this.$audio.src="http://aqqmusic.tc.qq.com/amobile.music.tc.qq.com/C400002TRY4a3zfxC8.m4a?guid=5561900148&vkey=7D51FAD7826BC57DA7A012F8D5F54F7E6F965EDD2DB6145A5ED872924D492058813AE9692036C9CE330CA6F29B36B56117DA99CCE6D82F30&uin=0&fromtag=38",fetch("https://c.y.qq.com/lyric/fcgi-bin/fcg_query_lyric.fcg?g_tk=5381&uin=0&format=json&inCharset=utf-8&outCharset=utf-8&notice=0&platform=h5&needNewCode=1&nobase64=1&musicid=".concat(e.songid,"&songtype=0&_=1565247849296&jsonpCallback=jsonp1")).then(function(t){return t.json}).then(function(t){return t.lyric}).then(function(e){return t.Lyrics.reset(e)}).catch(function(){})),this.show()}}},{key:"show",value:function(){this.$el.classList.contains("hide")&&(this.$el.classList.remove("hide"),this.$el.classList.add("show"))}},{key:"hide",value:function(){this.$el.classList.contains("show")&&(this.$el.classList.remove("show"),this.$el.classList.add("hide"))}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}n.d(e,"a",function(){return a});var a=function(){function t(e,n,s){i(this,t),this.$el=e,this.elapsed=0,this.duration=n||0,this.progress=0,this.render(),this.$progress=this.$el.querySelector(".progress-bar-progress"),this.$elapsed=this.$el.querySelector(".progress-elapsed"),this.$duration=this.$el.querySelector(".progress-duration"),this.$elapsed.innerText=this.formatTime(this.elapsed),this.$duration.innerText=this.formatTime(this.duration),s&&this.start()}return r(t,[{key:"start",value:function(){this.intervalId=setInterval(this.update.bind(this),1e3)}},{key:"pause",value:function(){clearInterval(this.intervalId)}},{key:"update",value:function(){this.elapsed>=this.duration&&this.reset(),this.elapsed+=1,this.progress=this.elapsed/this.duration,this.$progress.style.transform="translate(".concat(100*this.progress,"%)"),this.$elapsed.innerText=this.formatTime(this.elapsed)}},{key:"reset",value:function(t){this.pause(),this.elapsed=0,this.progress=0,t&&(this.duration=+t,this.$duration.innerText=this.formatTime(this.duration))}},{key:"render",value:function(){this.$el.innerHTML='\n\t\t\t<div class="progress-time progress-elapsed"></div>\n\t\t\t<div class="progress-bar">\n\t\t\t\t<div class="progress-bar-progress"></div>\n\t\t\t</div>\n\t\t\t<div class="progress-time progress-duration"></div>\n\t\t'}},{key:"formatTime",value:function(t){var e=Math.floor(t/60),n=Math.floor(t%60);return e<10&&(e="0"+e),n<10&&(n="0"+n),"".concat(e,":").concat(n)}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}n.d(e,"a",function(){return a});var a=function(){function t(e){i(this,t),this.$el=e,this.$el.innerHTML="<div class='lyric-line'></div>",this.$line=this.$el.querySelector(".lyric-line"),this.text="",this.index=0,this.elapsed=0,this.lyrics=[],this.reset(this.text)}return r(t,[{key:"start",value:function(){console.log("1"),this.intervalId=setInterval(this.update.bind(this),1e3)}},{key:"pause",value:function(){clearInterval(this.intervalId)}},{key:"update",value:function(){if(console.log("2"),this.elapsed+=1,this.index===this.lyrics.length-1)return this.reset();for(var t=this.index+1;t<this.lyrics.length;t++){var e=this.getSeconds(this.lyrics[t]);if(this.elapsed===e&&(!this.lyrics[t+1]||this.elapsed<this.getSeconds(this.lyrics[t+1]))){this.$line.children[this.index].classList.remove("active"),this.$line.children[t].classList.add("active"),this.index=t;break}}if(this.index>2){var n=-(this.index-2)*this.LINE_HEIGHT;this.$line.style.transform="translateY(".concat(n,"px)")}}},{key:"reset",value:function(t){this.pause(),this.index=0,this.elapsed=0,t&&(this.text=this.formatText(t)||"",this.lyrics=this.text.match(/^\[\d{2}:\d{2}.\d{2}\](.+)$/gm)||[],this.lyrics.length&&(this.render(),this.$line.children[this.index].classList.add("active")))}},{key:"restart",value:function(){this.reset(),this.start()}},{key:"getSeconds",value:function(t){return+t.replace(/^\[(\d{2}):(\d{2}).*/,function(t,e,n){return 60*+e+ +n})}},{key:"render",value:function(){var t=this.lyrics.map(function(t){return'\n\t\t\t<div class="lyrics-lines">'.concat(t.slice(10),"</div>\t\t\n\t\t")}).join("");this.$line.innerHTML=t}},{key:"formatText",value:function(t){var e=document.createElement("div");return e.innerHTML=t,e.innerText}}]),t}();a.prototype.LINE_HEIGHT=42}]);